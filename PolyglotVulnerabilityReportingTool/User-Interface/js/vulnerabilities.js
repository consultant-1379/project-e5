document.addEventListener("DOMContentLoaded", function () {
    const tableBody = document.querySelector("#vulnerabilities-table tbody");

    fetch("http://localhost:8080/vulnerabilities", {
        method: 'GET',
        mode: 'cors',              // Set CORS mode
        credentials: 'same-origin' // Set credentials mode
    })
    .then((response) => response.json())
    .then((data) => {
        data.forEach((item) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${item.id}</td>
                <td>${item.reportId}</td>
                <td>${item.dependency}</td>
                <td>${item.vulnerabilityId}</td>
                <td>${item.packageName}</td>
                <td>${item.highestSeverity}</td>
                <td>${item.cveCount}</td>
                <td>${item.confidence}</td>
                <td>${item.evidenceCount}</td>
                <td><a href="${item.vulnerabilityUrl}" target="_blank">${item.vulnerabilityUrl}</a></td>
                <td><a href="${item.packageUrl}" target="_blank">${item.packageUrl}</a></td>
            `;
            tableBody.appendChild(row);
        });
    });
});