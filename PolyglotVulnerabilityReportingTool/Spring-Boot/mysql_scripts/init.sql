CREATE DATABASE dependencyDb;
USE `dependencyDb`;

GRANT ALL PRIVILEGES ON dependencyDb.* TO 'user'@'%';

DROP TABLE IF EXISTS `repository`;

CREATE TABLE `repository` (
    `id` int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `projectName` varchar(200) NOT NULL,
    `groupId` varchar(200) NOT NULL,
    `artifactId` varchar(200) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `report` (
    `id` int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `repositoryId` int(11) NOT NULL,
    `datetime` varchar(50) NOT NULL,
    `reportSchema` varchar(200) NOT NULL,
    `engineVersion` varchar(200) NOT NULL, 
    CONSTRAINT `report_ibfk_1` FOREIGN KEY (`repositoryId`) REFERENCES `repository`(`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `vulnerability` (
	`id` int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
	`reportId` int(11) NOT NULL,
	`dependency` varchar(200) NOT NULL,
	`vulnerabilityId` varchar(200) NOT NULL,
	`package` varchar(200) NOT NULL,
	`highestSeverity` varchar(50) NOT NULL,
	`cveCount` varchar(200) NOT NULL,
	`confidence` varchar(200) NOT NULL,
	`evidenceCount` varchar(200) NOT NULL,
	`vulnerabilityUrl` varchar(3000) NOT NULL,
	`packageUrl` varchar(3000) NOT NULL,
	CONSTRAINT `vulnerability_ibfk_1` FOREIGN KEY (`reportId`) REFERENCES `report`(`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;


INSERT INTO repository (projectName, groupId, artifactId)
VALUES ('BabyENM', 'com.goTeam', 'BabyENM');

INSERT INTO report (repositoryId, datetime, reportSchema, engineVersion)
VALUES (1, '2023-08-04T09:32:33.323403900Z', '1.1', '6.4.1');

INSERT INTO vulnerability (reportId, dependency, vulnerabilityId, package, highestSeverity, cveCount, confidence,
evidenceCount, vulnerabilityUrl, packageUrl)
VALUES (1, 'angus-activation-2.0.1.jar', 'cpe:2.3:a:eclipse:eclipse_ide:2.0.1:*:*:*:*:*:*:*;',
'pkg:maven/org.eclipse.angus/angus-activation@2.0.1;', 'MEDIUM', '2', 'HIGHEST',
'36', ' https://nvd.nist.gov/vuln/search/results?form_type=Advanced&results_type=overview&search_type=all&cpe_vendor=cpe%3A%2F%3Aeclipse&cpe_product=cpe%3A%2F%3Aeclipse%3Aeclipse_ide&cpe_version=cpe%3A%2F%3Aeclipse%3Aeclipse_ide%3A2.0.1;',
'https://ossindex.sonatype.org/component/pkg:maven/org.eclipse.angus/angus-activation@2.0.1?utm_source=dependency-check&utm_medium=integration&utm_content=6.4.1;');
